name: Test PowerShell on Windows
on: push

jobs:
  pester-test:
    name: Pester test
    runs-on: windows-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v4
      - name: Perform a Pester test from the command-line
        shell: pwsh
        run: |
          ls env:
          $env:TESTTEST -split '' -join ','
          gcm Remove-WindowsCapability
          dism /online /?
        env:
          TESTTEST: ${{ secrets.SECRET_TEST }}
          HELLO: world
      - name: Node.js task
        run: node .
        env:
          ACCOUNT_ID: ACCOUNT_ID
          ACCESS_KEY_ID: ACCESS_KEY_ID
          SECRET_ACCESS_KEY: SECRET_ACCESS_KEY
